{
  "description": "TC-CONSUME-003: remaining_count=1から0への遷移テスト",
  "test_id": "BOUNDARY-001",
  "order": {
    "email": "customer@example.com",
    "fulfillment_status": "unfulfilled",
    "send_receipt": false,
    "send_fulfillment_receipt": false,
    "note": "テスト注文: クーポン残回数1→0への遷移テスト",
    "tags": "test, boundary, remaining-count, transition",
    "line_items": [
      {
        "variant_id": null,
        "quantity": 1,
        "title": "テスト商品（残回数1消費テスト）",
        "price": "2500.00",
        "grams": 750,
        "sku": "TEST-BOUNDARY-001",
        "requires_shipping": true
      }
    ],
    "shipping_address": {
      "first_name": "太郎",
      "last_name": "境界",
      "company": null,
      "address1": "1-1-1",
      "address2": null,
      "city": "横浜市西区",
      "province": "神奈川県",
      "province_code": "JP-14",
      "country": "Japan",
      "country_code": "JP",
      "zip": "220-0001",
      "phone": "045-1234-5678"
    },
    "shipping_lines": [
      {
        "title": "ヤマト運輸 宅急便 60サイズ",
        "price": "1.00",
        "code": "YAMATO_TAKKYUBIN_60",
        "source": "plusshipping"
      }
    ],
    "financial_status": "pending"
  },
  "shipping_metadata": {
    "carrier": "yamato",
    "service_type": "YAMATO_SERVICE_TYPE_TAKKYUBIN",
    "packing_size": 60,
    "consignor_prefecture": "東京都",
    "destination_prefecture": "神奈川県",
    "purchase_type": "single",
    "campaign_id": 6,
    "expected_fee": 1
  },
  "test_expectations": {
    "coupon_applied": true,
    "total_shipping_fee": 1,
    "campaign_id": 6,
    "remaining_count_before": 1,
    "remaining_count_after": 0,
    "note": "消費後、次回はクーポンが利用不可になる"
  },
  "test_procedure": [
    "1. 事前にcampaign_coupon_statusesでremaining_count=1に設定",
    "2. 単品購入APIを実行",
    "3. remaining_count=0に減算されることを確認",
    "4. 再度送料計算APIを呼び出し、クーポンが利用不可になることを確認"
  ]
}
